<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>MatchDay Navigator • World Cup 2026 (Single-file, No-Animation)</title>

  <!-- (We intentionally do NOT link external leaflet.css here) -->

  <style>
    /* ====== Your dark layout ====== */
    :root { --bg:#0b0e12; --text:#dfe7f3; --line:#1c2430; }
    * { box-sizing: border-box; }
    html, body { height: 100%; margin: 0; }
    body { background: var(--bg); color: var(--text); font: 14px/1.4 system-ui, Arial, sans-serif; }
    header.top { height:56px; display:flex; align-items:center; padding:8px 14px; border-bottom:1px solid var(--line); background:#0d1117; }
    header .brand { font-weight:700; color:#eaf2ff; }
    main { height: calc(100vh - 56px); }
    #map { width:100%; height:100%; background:#000; }

    /* ====== CRITICAL Leaflet layout rules (subset) ====== */
    .leaflet-container { overflow: hidden; outline: 0; }
    .leaflet-pane,
    .leaflet-tile,
    .leaflet-marker-icon,
    .leaflet-marker-shadow,
    .leaflet-tile-container,
    .leaflet-pane > svg,
    .leaflet-pane > canvas,
    .leaflet-zoom-box,
    .leaflet-image-layer,
    .leaflet-layer { position: absolute; left: 0; top: 0; }
    .leaflet-pane { z-index: 400; }
    .leaflet-map-pane    { z-index: 200; }
    .leaflet-tile-pane   { z-index: 200; }
    .leaflet-overlay-pane{ z-index: 400; }
    .leaflet-marker-pane { z-index: 600; }
    .leaflet-tooltip-pane{ z-index: 650; }
    .leaflet-popup-pane  { z-index: 700; }
    .leaflet-tile { width:256px; height:256px; user-select:none; -webkit-user-drag:none; }
    .leaflet-container img { max-width: none !important; }
    .leaflet-zoom-animated { transform-origin: 0 0; }
    /* We’re disabling animation in JS anyway, but keep this for safety */
    .leaflet-zoom-anim .leaflet-zoom-animated { transition: none !important; }
    .leaflet-tile-container { pointer-events: none; }
    .leaflet-marker-icon, .leaflet-marker-shadow, .leaflet-image-layer, .leaflet-pane > svg path { pointer-events:auto; }

    /* (Dark UI polish for controls & popups) */
    .leaflet-control-zoom a { background:#0f141c; color:#cfe5ff; border:1px solid #1a2230; }
    .leaflet-popup-content-wrapper { background:#0f141c; color:#eaf2ff; border:1px solid #1a2230; }
    .leaflet-popup-tip { background:#0f141c; }
    .leaflet-tooltip { background:#0f141c; color:#cfe5ff; border:1px solid #1a2230; }
  </style>
</head>
<body>
  <header class="top">
    <div class="brand">MatchDay Navigator</div>
  </header>

  <main>
    <div id="map" aria-label="World Cup 2026 Map"></div>
  </main>

  <!-- Leaflet JS (CDN) -->
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"
          integrity="sha256-20nQCchB9co0qIjJZRGuk2/Z9VM+kNiyxNV1lvTlZBo="
          crossorigin="anonymous"></script>

  <script>
    // Init dark base map (Carto Dark Matter) with animations OFF
    const map = L.map('map', {
      zoomControl: true,
      worldCopyJump: true,
      zoomAnimation: false,
      fadeAnimation: false
    });

    const tiles = L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png', {
      attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
      subdomains: 'abcd',
      maxZoom: 20
    }).addTo(map);

    // Simple SVG pin (city=blue)
    const svgPin = (fill, stroke = '#0a3d62') => {
      const svg = `
        <svg xmlns='http://www.w3.org/2000/svg' width='25' height='41' viewBox='0 0 25 41'>
          <path d='M12.5 0C5.6 0 0 5.6 0 12.5c0 9.2 10.6 17.2 11.2 17.7a2 2 0 0 0 2.6 0C14.4 29.7 25 21.7 25 12.5 25 5.6 19.4 0 12.5 0z'
                fill='${fill}' stroke='${stroke}' stroke-width='1'/>
          <circle cx='12.5' cy='12.5' r='5' fill='#fff'/>
        </svg>`;
      return 'data:image/svg+xml;utf8,' + encodeURIComponent(svg);
    };
    const ICON_CITY = L.icon({ iconUrl: svgPin('#1e90ff'), iconSize:[25,41], iconAnchor:[12,41], popupAnchor:[0,-36] });

    // Fallback cities so you see pins immediately
    const CITIES = [
      { name:'New York / New Jersey', country:'USA', lat:40.813528, lng:-74.074361 },
      { name:'Dallas (Arlington)',    country:'USA', lat:32.747780, lng:-97.092780 },
      { name:'Houston',               country:'USA', lat:29.684720, lng:-95.410830 },
      { name:'Kansas City',           country:'USA', lat:39.048890, lng:-94.483890 },
      { name:'Atlanta',               country:'USA', lat:33.755560, lng:-84.400000 },
      { name:'Los Angeles',           country:'USA', lat:33.953000, lng:-118.339000 },
      { name:'Toronto',               country:'Canada', lat:43.633330, lng:-79.418610 },
      { name:'Vancouver',             country:'Canada', lat:49.276684, lng:-123.112404 },
      { name:'Mexico City',           country:'Mexico', lat:19.303060, lng:-99.150560 },
      { name:'Guadalajara',           country:'Mexico', lat:20.681670, lng:-103.462780 },
      { name:'Monterrey',             country:'Mexico', lat:25.669170, lng:-100.244440 }
    ];

    const markers = CITIES.map(c => {
      const m = L.marker([c.lat, c.lng], { icon: ICON_CITY })
        .bindPopup(`<b>${c.name}</b><br/>${c.country}`)
        .bindTooltip(c.name);
      m.addTo(map);
      return m;
    });

    if (markers.length) {
      const fg = L.featureGroup(markers);
      map.fitBounds(fg.getBounds(), { padding:[40,40] });
    } else {
      map.setView([37.8, -96], 4);
    }

    // Finalize layout to prevent any residual patchiness
    window.addEventListener('load', () => map.invalidateSize());
    tiles.on('load', () => map.invalidateSize());
    requestAnimationFrame(() => map.invalidateSize());
    window.addEventListener('resize', () => map.invalidateSize());
  </script>
</body>
</html>